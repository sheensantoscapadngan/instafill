{"ast":null,"code":"/*\n * Copyright 1996-2003 Glyph & Cog, LLC\n *\n * The flate stream implementation contained in this file is a JavaScript port\n * of XPDF's implementation, made available under the Apache 2.0 open source\n * license.\n */\nimport { __extends } from \"tslib\";\n/*\n * Copyright 2012 Mozilla Foundation\n *\n * The FlateStream class contained in this file is a TypeScript port of the\n * JavaScript FlateStream class in Mozilla's pdf.js project, made available\n * under the Apache 2.0 open source license.\n */\n\n/* tslint:disable  no-conditional-assignment */\n\nimport DecodeStream from \"./DecodeStream\"; // prettier-ignore\n\nvar codeLenCodeMap = new Int32Array([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]); // prettier-ignore\n\nvar lengthDecode = new Int32Array([0x00003, 0x00004, 0x00005, 0x00006, 0x00007, 0x00008, 0x00009, 0x0000a, 0x1000b, 0x1000d, 0x1000f, 0x10011, 0x20013, 0x20017, 0x2001b, 0x2001f, 0x30023, 0x3002b, 0x30033, 0x3003b, 0x40043, 0x40053, 0x40063, 0x40073, 0x50083, 0x500a3, 0x500c3, 0x500e3, 0x00102, 0x00102, 0x00102]); // prettier-ignore\n\nvar distDecode = new Int32Array([0x00001, 0x00002, 0x00003, 0x00004, 0x10005, 0x10007, 0x20009, 0x2000d, 0x30011, 0x30019, 0x40021, 0x40031, 0x50041, 0x50061, 0x60081, 0x600c1, 0x70101, 0x70181, 0x80201, 0x80301, 0x90401, 0x90601, 0xa0801, 0xa0c01, 0xb1001, 0xb1801, 0xc2001, 0xc3001, 0xd4001, 0xd6001]); // prettier-ignore\n\nvar fixedLitCodeTab = [new Int32Array([0x70100, 0x80050, 0x80010, 0x80118, 0x70110, 0x80070, 0x80030, 0x900c0, 0x70108, 0x80060, 0x80020, 0x900a0, 0x80000, 0x80080, 0x80040, 0x900e0, 0x70104, 0x80058, 0x80018, 0x90090, 0x70114, 0x80078, 0x80038, 0x900d0, 0x7010c, 0x80068, 0x80028, 0x900b0, 0x80008, 0x80088, 0x80048, 0x900f0, 0x70102, 0x80054, 0x80014, 0x8011c, 0x70112, 0x80074, 0x80034, 0x900c8, 0x7010a, 0x80064, 0x80024, 0x900a8, 0x80004, 0x80084, 0x80044, 0x900e8, 0x70106, 0x8005c, 0x8001c, 0x90098, 0x70116, 0x8007c, 0x8003c, 0x900d8, 0x7010e, 0x8006c, 0x8002c, 0x900b8, 0x8000c, 0x8008c, 0x8004c, 0x900f8, 0x70101, 0x80052, 0x80012, 0x8011a, 0x70111, 0x80072, 0x80032, 0x900c4, 0x70109, 0x80062, 0x80022, 0x900a4, 0x80002, 0x80082, 0x80042, 0x900e4, 0x70105, 0x8005a, 0x8001a, 0x90094, 0x70115, 0x8007a, 0x8003a, 0x900d4, 0x7010d, 0x8006a, 0x8002a, 0x900b4, 0x8000a, 0x8008a, 0x8004a, 0x900f4, 0x70103, 0x80056, 0x80016, 0x8011e, 0x70113, 0x80076, 0x80036, 0x900cc, 0x7010b, 0x80066, 0x80026, 0x900ac, 0x80006, 0x80086, 0x80046, 0x900ec, 0x70107, 0x8005e, 0x8001e, 0x9009c, 0x70117, 0x8007e, 0x8003e, 0x900dc, 0x7010f, 0x8006e, 0x8002e, 0x900bc, 0x8000e, 0x8008e, 0x8004e, 0x900fc, 0x70100, 0x80051, 0x80011, 0x80119, 0x70110, 0x80071, 0x80031, 0x900c2, 0x70108, 0x80061, 0x80021, 0x900a2, 0x80001, 0x80081, 0x80041, 0x900e2, 0x70104, 0x80059, 0x80019, 0x90092, 0x70114, 0x80079, 0x80039, 0x900d2, 0x7010c, 0x80069, 0x80029, 0x900b2, 0x80009, 0x80089, 0x80049, 0x900f2, 0x70102, 0x80055, 0x80015, 0x8011d, 0x70112, 0x80075, 0x80035, 0x900ca, 0x7010a, 0x80065, 0x80025, 0x900aa, 0x80005, 0x80085, 0x80045, 0x900ea, 0x70106, 0x8005d, 0x8001d, 0x9009a, 0x70116, 0x8007d, 0x8003d, 0x900da, 0x7010e, 0x8006d, 0x8002d, 0x900ba, 0x8000d, 0x8008d, 0x8004d, 0x900fa, 0x70101, 0x80053, 0x80013, 0x8011b, 0x70111, 0x80073, 0x80033, 0x900c6, 0x70109, 0x80063, 0x80023, 0x900a6, 0x80003, 0x80083, 0x80043, 0x900e6, 0x70105, 0x8005b, 0x8001b, 0x90096, 0x70115, 0x8007b, 0x8003b, 0x900d6, 0x7010d, 0x8006b, 0x8002b, 0x900b6, 0x8000b, 0x8008b, 0x8004b, 0x900f6, 0x70103, 0x80057, 0x80017, 0x8011f, 0x70113, 0x80077, 0x80037, 0x900ce, 0x7010b, 0x80067, 0x80027, 0x900ae, 0x80007, 0x80087, 0x80047, 0x900ee, 0x70107, 0x8005f, 0x8001f, 0x9009e, 0x70117, 0x8007f, 0x8003f, 0x900de, 0x7010f, 0x8006f, 0x8002f, 0x900be, 0x8000f, 0x8008f, 0x8004f, 0x900fe, 0x70100, 0x80050, 0x80010, 0x80118, 0x70110, 0x80070, 0x80030, 0x900c1, 0x70108, 0x80060, 0x80020, 0x900a1, 0x80000, 0x80080, 0x80040, 0x900e1, 0x70104, 0x80058, 0x80018, 0x90091, 0x70114, 0x80078, 0x80038, 0x900d1, 0x7010c, 0x80068, 0x80028, 0x900b1, 0x80008, 0x80088, 0x80048, 0x900f1, 0x70102, 0x80054, 0x80014, 0x8011c, 0x70112, 0x80074, 0x80034, 0x900c9, 0x7010a, 0x80064, 0x80024, 0x900a9, 0x80004, 0x80084, 0x80044, 0x900e9, 0x70106, 0x8005c, 0x8001c, 0x90099, 0x70116, 0x8007c, 0x8003c, 0x900d9, 0x7010e, 0x8006c, 0x8002c, 0x900b9, 0x8000c, 0x8008c, 0x8004c, 0x900f9, 0x70101, 0x80052, 0x80012, 0x8011a, 0x70111, 0x80072, 0x80032, 0x900c5, 0x70109, 0x80062, 0x80022, 0x900a5, 0x80002, 0x80082, 0x80042, 0x900e5, 0x70105, 0x8005a, 0x8001a, 0x90095, 0x70115, 0x8007a, 0x8003a, 0x900d5, 0x7010d, 0x8006a, 0x8002a, 0x900b5, 0x8000a, 0x8008a, 0x8004a, 0x900f5, 0x70103, 0x80056, 0x80016, 0x8011e, 0x70113, 0x80076, 0x80036, 0x900cd, 0x7010b, 0x80066, 0x80026, 0x900ad, 0x80006, 0x80086, 0x80046, 0x900ed, 0x70107, 0x8005e, 0x8001e, 0x9009d, 0x70117, 0x8007e, 0x8003e, 0x900dd, 0x7010f, 0x8006e, 0x8002e, 0x900bd, 0x8000e, 0x8008e, 0x8004e, 0x900fd, 0x70100, 0x80051, 0x80011, 0x80119, 0x70110, 0x80071, 0x80031, 0x900c3, 0x70108, 0x80061, 0x80021, 0x900a3, 0x80001, 0x80081, 0x80041, 0x900e3, 0x70104, 0x80059, 0x80019, 0x90093, 0x70114, 0x80079, 0x80039, 0x900d3, 0x7010c, 0x80069, 0x80029, 0x900b3, 0x80009, 0x80089, 0x80049, 0x900f3, 0x70102, 0x80055, 0x80015, 0x8011d, 0x70112, 0x80075, 0x80035, 0x900cb, 0x7010a, 0x80065, 0x80025, 0x900ab, 0x80005, 0x80085, 0x80045, 0x900eb, 0x70106, 0x8005d, 0x8001d, 0x9009b, 0x70116, 0x8007d, 0x8003d, 0x900db, 0x7010e, 0x8006d, 0x8002d, 0x900bb, 0x8000d, 0x8008d, 0x8004d, 0x900fb, 0x70101, 0x80053, 0x80013, 0x8011b, 0x70111, 0x80073, 0x80033, 0x900c7, 0x70109, 0x80063, 0x80023, 0x900a7, 0x80003, 0x80083, 0x80043, 0x900e7, 0x70105, 0x8005b, 0x8001b, 0x90097, 0x70115, 0x8007b, 0x8003b, 0x900d7, 0x7010d, 0x8006b, 0x8002b, 0x900b7, 0x8000b, 0x8008b, 0x8004b, 0x900f7, 0x70103, 0x80057, 0x80017, 0x8011f, 0x70113, 0x80077, 0x80037, 0x900cf, 0x7010b, 0x80067, 0x80027, 0x900af, 0x80007, 0x80087, 0x80047, 0x900ef, 0x70107, 0x8005f, 0x8001f, 0x9009f, 0x70117, 0x8007f, 0x8003f, 0x900df, 0x7010f, 0x8006f, 0x8002f, 0x900bf, 0x8000f, 0x8008f, 0x8004f, 0x900ff]), 9]; // prettier-ignore\n\nvar fixedDistCodeTab = [new Int32Array([0x50000, 0x50010, 0x50008, 0x50018, 0x50004, 0x50014, 0x5000c, 0x5001c, 0x50002, 0x50012, 0x5000a, 0x5001a, 0x50006, 0x50016, 0x5000e, 0x00000, 0x50001, 0x50011, 0x50009, 0x50019, 0x50005, 0x50015, 0x5000d, 0x5001d, 0x50003, 0x50013, 0x5000b, 0x5001b, 0x50007, 0x50017, 0x5000f, 0x00000]), 5];\n\nvar FlateStream =\n/** @class */\nfunction (_super) {\n  __extends(FlateStream, _super);\n\n  function FlateStream(stream, maybeLength) {\n    var _this = _super.call(this, maybeLength) || this;\n\n    _this.stream = stream;\n    var cmf = stream.getByte();\n    var flg = stream.getByte();\n\n    if (cmf === -1 || flg === -1) {\n      throw new Error(\"Invalid header in flate stream: \" + cmf + \", \" + flg);\n    }\n\n    if ((cmf & 0x0f) !== 0x08) {\n      throw new Error(\"Unknown compression method in flate stream: \" + cmf + \", \" + flg);\n    }\n\n    if (((cmf << 8) + flg) % 31 !== 0) {\n      throw new Error(\"Bad FCHECK in flate stream: \" + cmf + \", \" + flg);\n    }\n\n    if (flg & 0x20) {\n      throw new Error(\"FDICT bit set in flate stream: \" + cmf + \", \" + flg);\n    }\n\n    _this.codeSize = 0;\n    _this.codeBuf = 0;\n    return _this;\n  }\n\n  FlateStream.prototype.readBlock = function () {\n    var buffer;\n    var len;\n    var str = this.stream; // read block header\n\n    var hdr = this.getBits(3);\n\n    if (hdr & 1) {\n      this.eof = true;\n    }\n\n    hdr >>= 1;\n\n    if (hdr === 0) {\n      // uncompressed block\n      var b = void 0;\n\n      if ((b = str.getByte()) === -1) {\n        throw new Error('Bad block header in flate stream');\n      }\n\n      var blockLen = b;\n\n      if ((b = str.getByte()) === -1) {\n        throw new Error('Bad block header in flate stream');\n      }\n\n      blockLen |= b << 8;\n\n      if ((b = str.getByte()) === -1) {\n        throw new Error('Bad block header in flate stream');\n      }\n\n      var check = b;\n\n      if ((b = str.getByte()) === -1) {\n        throw new Error('Bad block header in flate stream');\n      }\n\n      check |= b << 8;\n\n      if (check !== (~blockLen & 0xffff) && (blockLen !== 0 || check !== 0)) {\n        // Ignoring error for bad \"empty\" block (see issue 1277)\n        throw new Error('Bad uncompressed block length in flate stream');\n      }\n\n      this.codeBuf = 0;\n      this.codeSize = 0;\n      var bufferLength = this.bufferLength;\n      buffer = this.ensureBuffer(bufferLength + blockLen);\n      var end = bufferLength + blockLen;\n      this.bufferLength = end;\n\n      if (blockLen === 0) {\n        if (str.peekByte() === -1) {\n          this.eof = true;\n        }\n      } else {\n        for (var n = bufferLength; n < end; ++n) {\n          if ((b = str.getByte()) === -1) {\n            this.eof = true;\n            break;\n          }\n\n          buffer[n] = b;\n        }\n      }\n\n      return;\n    }\n\n    var litCodeTable;\n    var distCodeTable;\n\n    if (hdr === 1) {\n      // compressed block, fixed codes\n      litCodeTable = fixedLitCodeTab;\n      distCodeTable = fixedDistCodeTab;\n    } else if (hdr === 2) {\n      // compressed block, dynamic codes\n      var numLitCodes = this.getBits(5) + 257;\n      var numDistCodes = this.getBits(5) + 1;\n      var numCodeLenCodes = this.getBits(4) + 4; // build the code lengths code table\n\n      var codeLenCodeLengths = new Uint8Array(codeLenCodeMap.length);\n      var i = void 0;\n\n      for (i = 0; i < numCodeLenCodes; ++i) {\n        codeLenCodeLengths[codeLenCodeMap[i]] = this.getBits(3);\n      }\n\n      var codeLenCodeTab = this.generateHuffmanTable(codeLenCodeLengths); // build the literal and distance code tables\n\n      len = 0;\n      i = 0;\n      var codes = numLitCodes + numDistCodes;\n      var codeLengths = new Uint8Array(codes);\n      var bitsLength = void 0;\n      var bitsOffset = void 0;\n      var what = void 0;\n\n      while (i < codes) {\n        var code = this.getCode(codeLenCodeTab);\n\n        if (code === 16) {\n          bitsLength = 2;\n          bitsOffset = 3;\n          what = len;\n        } else if (code === 17) {\n          bitsLength = 3;\n          bitsOffset = 3;\n          what = len = 0;\n        } else if (code === 18) {\n          bitsLength = 7;\n          bitsOffset = 11;\n          what = len = 0;\n        } else {\n          codeLengths[i++] = len = code;\n          continue;\n        }\n\n        var repeatLength = this.getBits(bitsLength) + bitsOffset;\n\n        while (repeatLength-- > 0) {\n          codeLengths[i++] = what;\n        }\n      }\n\n      litCodeTable = this.generateHuffmanTable(codeLengths.subarray(0, numLitCodes));\n      distCodeTable = this.generateHuffmanTable(codeLengths.subarray(numLitCodes, codes));\n    } else {\n      throw new Error('Unknown block type in flate stream');\n    }\n\n    buffer = this.buffer;\n    var limit = buffer ? buffer.length : 0;\n    var pos = this.bufferLength;\n\n    while (true) {\n      var code1 = this.getCode(litCodeTable);\n\n      if (code1 < 256) {\n        if (pos + 1 >= limit) {\n          buffer = this.ensureBuffer(pos + 1);\n          limit = buffer.length;\n        }\n\n        buffer[pos++] = code1;\n        continue;\n      }\n\n      if (code1 === 256) {\n        this.bufferLength = pos;\n        return;\n      }\n\n      code1 -= 257;\n      code1 = lengthDecode[code1];\n      var code2 = code1 >> 16;\n\n      if (code2 > 0) {\n        code2 = this.getBits(code2);\n      }\n\n      len = (code1 & 0xffff) + code2;\n      code1 = this.getCode(distCodeTable);\n      code1 = distDecode[code1];\n      code2 = code1 >> 16;\n\n      if (code2 > 0) {\n        code2 = this.getBits(code2);\n      }\n\n      var dist = (code1 & 0xffff) + code2;\n\n      if (pos + len >= limit) {\n        buffer = this.ensureBuffer(pos + len);\n        limit = buffer.length;\n      }\n\n      for (var k = 0; k < len; ++k, ++pos) {\n        buffer[pos] = buffer[pos - dist];\n      }\n    }\n  };\n\n  FlateStream.prototype.getBits = function (bits) {\n    var str = this.stream;\n    var codeSize = this.codeSize;\n    var codeBuf = this.codeBuf;\n    var b;\n\n    while (codeSize < bits) {\n      if ((b = str.getByte()) === -1) {\n        throw new Error('Bad encoding in flate stream');\n      }\n\n      codeBuf |= b << codeSize;\n      codeSize += 8;\n    }\n\n    b = codeBuf & (1 << bits) - 1;\n    this.codeBuf = codeBuf >> bits;\n    this.codeSize = codeSize -= bits;\n    return b;\n  };\n\n  FlateStream.prototype.getCode = function (table) {\n    var str = this.stream;\n    var codes = table[0];\n    var maxLen = table[1];\n    var codeSize = this.codeSize;\n    var codeBuf = this.codeBuf;\n    var b;\n\n    while (codeSize < maxLen) {\n      if ((b = str.getByte()) === -1) {\n        // premature end of stream. code might however still be valid.\n        // codeSize < codeLen check below guards against incomplete codeVal.\n        break;\n      }\n\n      codeBuf |= b << codeSize;\n      codeSize += 8;\n    }\n\n    var code = codes[codeBuf & (1 << maxLen) - 1];\n\n    if (typeof codes === 'number') {\n      console.log('FLATE:', code);\n    }\n\n    var codeLen = code >> 16;\n    var codeVal = code & 0xffff;\n\n    if (codeLen < 1 || codeSize < codeLen) {\n      throw new Error('Bad encoding in flate stream');\n    }\n\n    this.codeBuf = codeBuf >> codeLen;\n    this.codeSize = codeSize - codeLen;\n    return codeVal;\n  };\n\n  FlateStream.prototype.generateHuffmanTable = function (lengths) {\n    var n = lengths.length; // find max code length\n\n    var maxLen = 0;\n    var i;\n\n    for (i = 0; i < n; ++i) {\n      if (lengths[i] > maxLen) {\n        maxLen = lengths[i];\n      }\n    } // build the table\n\n\n    var size = 1 << maxLen;\n    var codes = new Int32Array(size);\n\n    for (var len = 1, code = 0, skip = 2; len <= maxLen; ++len, code <<= 1, skip <<= 1) {\n      for (var val = 0; val < n; ++val) {\n        if (lengths[val] === len) {\n          // bit-reverse the code\n          var code2 = 0;\n          var t = code;\n\n          for (i = 0; i < len; ++i) {\n            code2 = code2 << 1 | t & 1;\n            t >>= 1;\n          } // fill the table entries\n\n\n          for (i = code2; i < size; i += skip) {\n            codes[i] = len << 16 | val;\n          }\n\n          ++code;\n        }\n      }\n    }\n\n    return [codes, maxLen];\n  };\n\n  return FlateStream;\n}(DecodeStream);\n\nexport default FlateStream;","map":{"version":3,"sources":["../../../src/core/streams/FlateStream.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/*\n * Copyright 1996-2003 Glyph & Cog, LLC\n *\n * The flate stream implementation contained in this file is a JavaScript port\n * of XPDF's implementation, made available under the Apache 2.0 open source\n * license.\n */\nimport { __extends } from \"tslib\";\n/*\n * Copyright 2012 Mozilla Foundation\n *\n * The FlateStream class contained in this file is a TypeScript port of the\n * JavaScript FlateStream class in Mozilla's pdf.js project, made available\n * under the Apache 2.0 open source license.\n */\n/* tslint:disable  no-conditional-assignment */\nimport DecodeStream from \"./DecodeStream\";\n// prettier-ignore\nvar codeLenCodeMap = new Int32Array([\n    16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15\n]);\n// prettier-ignore\nvar lengthDecode = new Int32Array([\n    0x00003, 0x00004, 0x00005, 0x00006, 0x00007, 0x00008, 0x00009, 0x0000a,\n    0x1000b, 0x1000d, 0x1000f, 0x10011, 0x20013, 0x20017, 0x2001b, 0x2001f,\n    0x30023, 0x3002b, 0x30033, 0x3003b, 0x40043, 0x40053, 0x40063, 0x40073,\n    0x50083, 0x500a3, 0x500c3, 0x500e3, 0x00102, 0x00102, 0x00102\n]);\n// prettier-ignore\nvar distDecode = new Int32Array([\n    0x00001, 0x00002, 0x00003, 0x00004, 0x10005, 0x10007, 0x20009, 0x2000d,\n    0x30011, 0x30019, 0x40021, 0x40031, 0x50041, 0x50061, 0x60081, 0x600c1,\n    0x70101, 0x70181, 0x80201, 0x80301, 0x90401, 0x90601, 0xa0801, 0xa0c01,\n    0xb1001, 0xb1801, 0xc2001, 0xc3001, 0xd4001, 0xd6001\n]);\n// prettier-ignore\nvar fixedLitCodeTab = [new Int32Array([\n        0x70100, 0x80050, 0x80010, 0x80118, 0x70110, 0x80070, 0x80030, 0x900c0,\n        0x70108, 0x80060, 0x80020, 0x900a0, 0x80000, 0x80080, 0x80040, 0x900e0,\n        0x70104, 0x80058, 0x80018, 0x90090, 0x70114, 0x80078, 0x80038, 0x900d0,\n        0x7010c, 0x80068, 0x80028, 0x900b0, 0x80008, 0x80088, 0x80048, 0x900f0,\n        0x70102, 0x80054, 0x80014, 0x8011c, 0x70112, 0x80074, 0x80034, 0x900c8,\n        0x7010a, 0x80064, 0x80024, 0x900a8, 0x80004, 0x80084, 0x80044, 0x900e8,\n        0x70106, 0x8005c, 0x8001c, 0x90098, 0x70116, 0x8007c, 0x8003c, 0x900d8,\n        0x7010e, 0x8006c, 0x8002c, 0x900b8, 0x8000c, 0x8008c, 0x8004c, 0x900f8,\n        0x70101, 0x80052, 0x80012, 0x8011a, 0x70111, 0x80072, 0x80032, 0x900c4,\n        0x70109, 0x80062, 0x80022, 0x900a4, 0x80002, 0x80082, 0x80042, 0x900e4,\n        0x70105, 0x8005a, 0x8001a, 0x90094, 0x70115, 0x8007a, 0x8003a, 0x900d4,\n        0x7010d, 0x8006a, 0x8002a, 0x900b4, 0x8000a, 0x8008a, 0x8004a, 0x900f4,\n        0x70103, 0x80056, 0x80016, 0x8011e, 0x70113, 0x80076, 0x80036, 0x900cc,\n        0x7010b, 0x80066, 0x80026, 0x900ac, 0x80006, 0x80086, 0x80046, 0x900ec,\n        0x70107, 0x8005e, 0x8001e, 0x9009c, 0x70117, 0x8007e, 0x8003e, 0x900dc,\n        0x7010f, 0x8006e, 0x8002e, 0x900bc, 0x8000e, 0x8008e, 0x8004e, 0x900fc,\n        0x70100, 0x80051, 0x80011, 0x80119, 0x70110, 0x80071, 0x80031, 0x900c2,\n        0x70108, 0x80061, 0x80021, 0x900a2, 0x80001, 0x80081, 0x80041, 0x900e2,\n        0x70104, 0x80059, 0x80019, 0x90092, 0x70114, 0x80079, 0x80039, 0x900d2,\n        0x7010c, 0x80069, 0x80029, 0x900b2, 0x80009, 0x80089, 0x80049, 0x900f2,\n        0x70102, 0x80055, 0x80015, 0x8011d, 0x70112, 0x80075, 0x80035, 0x900ca,\n        0x7010a, 0x80065, 0x80025, 0x900aa, 0x80005, 0x80085, 0x80045, 0x900ea,\n        0x70106, 0x8005d, 0x8001d, 0x9009a, 0x70116, 0x8007d, 0x8003d, 0x900da,\n        0x7010e, 0x8006d, 0x8002d, 0x900ba, 0x8000d, 0x8008d, 0x8004d, 0x900fa,\n        0x70101, 0x80053, 0x80013, 0x8011b, 0x70111, 0x80073, 0x80033, 0x900c6,\n        0x70109, 0x80063, 0x80023, 0x900a6, 0x80003, 0x80083, 0x80043, 0x900e6,\n        0x70105, 0x8005b, 0x8001b, 0x90096, 0x70115, 0x8007b, 0x8003b, 0x900d6,\n        0x7010d, 0x8006b, 0x8002b, 0x900b6, 0x8000b, 0x8008b, 0x8004b, 0x900f6,\n        0x70103, 0x80057, 0x80017, 0x8011f, 0x70113, 0x80077, 0x80037, 0x900ce,\n        0x7010b, 0x80067, 0x80027, 0x900ae, 0x80007, 0x80087, 0x80047, 0x900ee,\n        0x70107, 0x8005f, 0x8001f, 0x9009e, 0x70117, 0x8007f, 0x8003f, 0x900de,\n        0x7010f, 0x8006f, 0x8002f, 0x900be, 0x8000f, 0x8008f, 0x8004f, 0x900fe,\n        0x70100, 0x80050, 0x80010, 0x80118, 0x70110, 0x80070, 0x80030, 0x900c1,\n        0x70108, 0x80060, 0x80020, 0x900a1, 0x80000, 0x80080, 0x80040, 0x900e1,\n        0x70104, 0x80058, 0x80018, 0x90091, 0x70114, 0x80078, 0x80038, 0x900d1,\n        0x7010c, 0x80068, 0x80028, 0x900b1, 0x80008, 0x80088, 0x80048, 0x900f1,\n        0x70102, 0x80054, 0x80014, 0x8011c, 0x70112, 0x80074, 0x80034, 0x900c9,\n        0x7010a, 0x80064, 0x80024, 0x900a9, 0x80004, 0x80084, 0x80044, 0x900e9,\n        0x70106, 0x8005c, 0x8001c, 0x90099, 0x70116, 0x8007c, 0x8003c, 0x900d9,\n        0x7010e, 0x8006c, 0x8002c, 0x900b9, 0x8000c, 0x8008c, 0x8004c, 0x900f9,\n        0x70101, 0x80052, 0x80012, 0x8011a, 0x70111, 0x80072, 0x80032, 0x900c5,\n        0x70109, 0x80062, 0x80022, 0x900a5, 0x80002, 0x80082, 0x80042, 0x900e5,\n        0x70105, 0x8005a, 0x8001a, 0x90095, 0x70115, 0x8007a, 0x8003a, 0x900d5,\n        0x7010d, 0x8006a, 0x8002a, 0x900b5, 0x8000a, 0x8008a, 0x8004a, 0x900f5,\n        0x70103, 0x80056, 0x80016, 0x8011e, 0x70113, 0x80076, 0x80036, 0x900cd,\n        0x7010b, 0x80066, 0x80026, 0x900ad, 0x80006, 0x80086, 0x80046, 0x900ed,\n        0x70107, 0x8005e, 0x8001e, 0x9009d, 0x70117, 0x8007e, 0x8003e, 0x900dd,\n        0x7010f, 0x8006e, 0x8002e, 0x900bd, 0x8000e, 0x8008e, 0x8004e, 0x900fd,\n        0x70100, 0x80051, 0x80011, 0x80119, 0x70110, 0x80071, 0x80031, 0x900c3,\n        0x70108, 0x80061, 0x80021, 0x900a3, 0x80001, 0x80081, 0x80041, 0x900e3,\n        0x70104, 0x80059, 0x80019, 0x90093, 0x70114, 0x80079, 0x80039, 0x900d3,\n        0x7010c, 0x80069, 0x80029, 0x900b3, 0x80009, 0x80089, 0x80049, 0x900f3,\n        0x70102, 0x80055, 0x80015, 0x8011d, 0x70112, 0x80075, 0x80035, 0x900cb,\n        0x7010a, 0x80065, 0x80025, 0x900ab, 0x80005, 0x80085, 0x80045, 0x900eb,\n        0x70106, 0x8005d, 0x8001d, 0x9009b, 0x70116, 0x8007d, 0x8003d, 0x900db,\n        0x7010e, 0x8006d, 0x8002d, 0x900bb, 0x8000d, 0x8008d, 0x8004d, 0x900fb,\n        0x70101, 0x80053, 0x80013, 0x8011b, 0x70111, 0x80073, 0x80033, 0x900c7,\n        0x70109, 0x80063, 0x80023, 0x900a7, 0x80003, 0x80083, 0x80043, 0x900e7,\n        0x70105, 0x8005b, 0x8001b, 0x90097, 0x70115, 0x8007b, 0x8003b, 0x900d7,\n        0x7010d, 0x8006b, 0x8002b, 0x900b7, 0x8000b, 0x8008b, 0x8004b, 0x900f7,\n        0x70103, 0x80057, 0x80017, 0x8011f, 0x70113, 0x80077, 0x80037, 0x900cf,\n        0x7010b, 0x80067, 0x80027, 0x900af, 0x80007, 0x80087, 0x80047, 0x900ef,\n        0x70107, 0x8005f, 0x8001f, 0x9009f, 0x70117, 0x8007f, 0x8003f, 0x900df,\n        0x7010f, 0x8006f, 0x8002f, 0x900bf, 0x8000f, 0x8008f, 0x8004f, 0x900ff\n    ]), 9];\n// prettier-ignore\nvar fixedDistCodeTab = [new Int32Array([\n        0x50000, 0x50010, 0x50008, 0x50018, 0x50004, 0x50014, 0x5000c, 0x5001c,\n        0x50002, 0x50012, 0x5000a, 0x5001a, 0x50006, 0x50016, 0x5000e, 0x00000,\n        0x50001, 0x50011, 0x50009, 0x50019, 0x50005, 0x50015, 0x5000d, 0x5001d,\n        0x50003, 0x50013, 0x5000b, 0x5001b, 0x50007, 0x50017, 0x5000f, 0x00000\n    ]), 5];\nvar FlateStream = /** @class */ (function (_super) {\n    __extends(FlateStream, _super);\n    function FlateStream(stream, maybeLength) {\n        var _this = _super.call(this, maybeLength) || this;\n        _this.stream = stream;\n        var cmf = stream.getByte();\n        var flg = stream.getByte();\n        if (cmf === -1 || flg === -1) {\n            throw new Error(\"Invalid header in flate stream: \" + cmf + \", \" + flg);\n        }\n        if ((cmf & 0x0f) !== 0x08) {\n            throw new Error(\"Unknown compression method in flate stream: \" + cmf + \", \" + flg);\n        }\n        if (((cmf << 8) + flg) % 31 !== 0) {\n            throw new Error(\"Bad FCHECK in flate stream: \" + cmf + \", \" + flg);\n        }\n        if (flg & 0x20) {\n            throw new Error(\"FDICT bit set in flate stream: \" + cmf + \", \" + flg);\n        }\n        _this.codeSize = 0;\n        _this.codeBuf = 0;\n        return _this;\n    }\n    FlateStream.prototype.readBlock = function () {\n        var buffer;\n        var len;\n        var str = this.stream;\n        // read block header\n        var hdr = this.getBits(3);\n        if (hdr & 1) {\n            this.eof = true;\n        }\n        hdr >>= 1;\n        if (hdr === 0) {\n            // uncompressed block\n            var b = void 0;\n            if ((b = str.getByte()) === -1) {\n                throw new Error('Bad block header in flate stream');\n            }\n            var blockLen = b;\n            if ((b = str.getByte()) === -1) {\n                throw new Error('Bad block header in flate stream');\n            }\n            blockLen |= b << 8;\n            if ((b = str.getByte()) === -1) {\n                throw new Error('Bad block header in flate stream');\n            }\n            var check = b;\n            if ((b = str.getByte()) === -1) {\n                throw new Error('Bad block header in flate stream');\n            }\n            check |= b << 8;\n            if (check !== (~blockLen & 0xffff) && (blockLen !== 0 || check !== 0)) {\n                // Ignoring error for bad \"empty\" block (see issue 1277)\n                throw new Error('Bad uncompressed block length in flate stream');\n            }\n            this.codeBuf = 0;\n            this.codeSize = 0;\n            var bufferLength = this.bufferLength;\n            buffer = this.ensureBuffer(bufferLength + blockLen);\n            var end = bufferLength + blockLen;\n            this.bufferLength = end;\n            if (blockLen === 0) {\n                if (str.peekByte() === -1) {\n                    this.eof = true;\n                }\n            }\n            else {\n                for (var n = bufferLength; n < end; ++n) {\n                    if ((b = str.getByte()) === -1) {\n                        this.eof = true;\n                        break;\n                    }\n                    buffer[n] = b;\n                }\n            }\n            return;\n        }\n        var litCodeTable;\n        var distCodeTable;\n        if (hdr === 1) {\n            // compressed block, fixed codes\n            litCodeTable = fixedLitCodeTab;\n            distCodeTable = fixedDistCodeTab;\n        }\n        else if (hdr === 2) {\n            // compressed block, dynamic codes\n            var numLitCodes = this.getBits(5) + 257;\n            var numDistCodes = this.getBits(5) + 1;\n            var numCodeLenCodes = this.getBits(4) + 4;\n            // build the code lengths code table\n            var codeLenCodeLengths = new Uint8Array(codeLenCodeMap.length);\n            var i = void 0;\n            for (i = 0; i < numCodeLenCodes; ++i) {\n                codeLenCodeLengths[codeLenCodeMap[i]] = this.getBits(3);\n            }\n            var codeLenCodeTab = this.generateHuffmanTable(codeLenCodeLengths);\n            // build the literal and distance code tables\n            len = 0;\n            i = 0;\n            var codes = numLitCodes + numDistCodes;\n            var codeLengths = new Uint8Array(codes);\n            var bitsLength = void 0;\n            var bitsOffset = void 0;\n            var what = void 0;\n            while (i < codes) {\n                var code = this.getCode(codeLenCodeTab);\n                if (code === 16) {\n                    bitsLength = 2;\n                    bitsOffset = 3;\n                    what = len;\n                }\n                else if (code === 17) {\n                    bitsLength = 3;\n                    bitsOffset = 3;\n                    what = len = 0;\n                }\n                else if (code === 18) {\n                    bitsLength = 7;\n                    bitsOffset = 11;\n                    what = len = 0;\n                }\n                else {\n                    codeLengths[i++] = len = code;\n                    continue;\n                }\n                var repeatLength = this.getBits(bitsLength) + bitsOffset;\n                while (repeatLength-- > 0) {\n                    codeLengths[i++] = what;\n                }\n            }\n            litCodeTable = this.generateHuffmanTable(codeLengths.subarray(0, numLitCodes));\n            distCodeTable = this.generateHuffmanTable(codeLengths.subarray(numLitCodes, codes));\n        }\n        else {\n            throw new Error('Unknown block type in flate stream');\n        }\n        buffer = this.buffer;\n        var limit = buffer ? buffer.length : 0;\n        var pos = this.bufferLength;\n        while (true) {\n            var code1 = this.getCode(litCodeTable);\n            if (code1 < 256) {\n                if (pos + 1 >= limit) {\n                    buffer = this.ensureBuffer(pos + 1);\n                    limit = buffer.length;\n                }\n                buffer[pos++] = code1;\n                continue;\n            }\n            if (code1 === 256) {\n                this.bufferLength = pos;\n                return;\n            }\n            code1 -= 257;\n            code1 = lengthDecode[code1];\n            var code2 = code1 >> 16;\n            if (code2 > 0) {\n                code2 = this.getBits(code2);\n            }\n            len = (code1 & 0xffff) + code2;\n            code1 = this.getCode(distCodeTable);\n            code1 = distDecode[code1];\n            code2 = code1 >> 16;\n            if (code2 > 0) {\n                code2 = this.getBits(code2);\n            }\n            var dist = (code1 & 0xffff) + code2;\n            if (pos + len >= limit) {\n                buffer = this.ensureBuffer(pos + len);\n                limit = buffer.length;\n            }\n            for (var k = 0; k < len; ++k, ++pos) {\n                buffer[pos] = buffer[pos - dist];\n            }\n        }\n    };\n    FlateStream.prototype.getBits = function (bits) {\n        var str = this.stream;\n        var codeSize = this.codeSize;\n        var codeBuf = this.codeBuf;\n        var b;\n        while (codeSize < bits) {\n            if ((b = str.getByte()) === -1) {\n                throw new Error('Bad encoding in flate stream');\n            }\n            codeBuf |= b << codeSize;\n            codeSize += 8;\n        }\n        b = codeBuf & ((1 << bits) - 1);\n        this.codeBuf = codeBuf >> bits;\n        this.codeSize = codeSize -= bits;\n        return b;\n    };\n    FlateStream.prototype.getCode = function (table) {\n        var str = this.stream;\n        var codes = table[0];\n        var maxLen = table[1];\n        var codeSize = this.codeSize;\n        var codeBuf = this.codeBuf;\n        var b;\n        while (codeSize < maxLen) {\n            if ((b = str.getByte()) === -1) {\n                // premature end of stream. code might however still be valid.\n                // codeSize < codeLen check below guards against incomplete codeVal.\n                break;\n            }\n            codeBuf |= b << codeSize;\n            codeSize += 8;\n        }\n        var code = codes[codeBuf & ((1 << maxLen) - 1)];\n        if (typeof codes === 'number') {\n            console.log('FLATE:', code);\n        }\n        var codeLen = code >> 16;\n        var codeVal = code & 0xffff;\n        if (codeLen < 1 || codeSize < codeLen) {\n            throw new Error('Bad encoding in flate stream');\n        }\n        this.codeBuf = codeBuf >> codeLen;\n        this.codeSize = codeSize - codeLen;\n        return codeVal;\n    };\n    FlateStream.prototype.generateHuffmanTable = function (lengths) {\n        var n = lengths.length;\n        // find max code length\n        var maxLen = 0;\n        var i;\n        for (i = 0; i < n; ++i) {\n            if (lengths[i] > maxLen) {\n                maxLen = lengths[i];\n            }\n        }\n        // build the table\n        var size = 1 << maxLen;\n        var codes = new Int32Array(size);\n        for (var len = 1, code = 0, skip = 2; len <= maxLen; ++len, code <<= 1, skip <<= 1) {\n            for (var val = 0; val < n; ++val) {\n                if (lengths[val] === len) {\n                    // bit-reverse the code\n                    var code2 = 0;\n                    var t = code;\n                    for (i = 0; i < len; ++i) {\n                        code2 = (code2 << 1) | (t & 1);\n                        t >>= 1;\n                    }\n                    // fill the table entries\n                    for (i = code2; i < size; i += skip) {\n                        codes[i] = (len << 16) | val;\n                    }\n                    ++code;\n                }\n            }\n        }\n        return [codes, maxLen];\n    };\n    return FlateStream;\n}(DecodeStream));\nexport default FlateStream;\n//# sourceMappingURL=FlateStream.js.map"]},"metadata":{},"sourceType":"module"}