{"ast":null,"code":"import PDFDict from \"../objects/PDFDict\";\nimport PDFName from \"../objects/PDFName\";\nimport PDFStream from \"../objects/PDFStream\";\nimport PDFArray from \"../objects/PDFArray\";\nimport PDFRef from \"../objects/PDFRef\";\nimport PDFNumber from \"../objects/PDFNumber\";\n\nvar PDFAnnotation =\n/** @class */\nfunction () {\n  function PDFAnnotation(dict) {\n    this.dict = dict;\n  } // This is technically required by the PDF spec\n\n\n  PDFAnnotation.prototype.Rect = function () {\n    return this.dict.lookup(PDFName.of('Rect'), PDFArray);\n  };\n\n  PDFAnnotation.prototype.AP = function () {\n    return this.dict.lookupMaybe(PDFName.of('AP'), PDFDict);\n  };\n\n  PDFAnnotation.prototype.F = function () {\n    var numberOrRef = this.dict.lookup(PDFName.of('F'));\n    return this.dict.context.lookupMaybe(numberOrRef, PDFNumber);\n  };\n\n  PDFAnnotation.prototype.getRectangle = function () {\n    var _a;\n\n    var Rect = this.Rect();\n    return (_a = Rect === null || Rect === void 0 ? void 0 : Rect.asRectangle()) !== null && _a !== void 0 ? _a : {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0\n    };\n  };\n\n  PDFAnnotation.prototype.setRectangle = function (rect) {\n    var x = rect.x,\n        y = rect.y,\n        width = rect.width,\n        height = rect.height;\n    var Rect = this.dict.context.obj([x, y, x + width, y + height]);\n    this.dict.set(PDFName.of('Rect'), Rect);\n  };\n\n  PDFAnnotation.prototype.getAppearanceState = function () {\n    var AS = this.dict.lookup(PDFName.of('AS'));\n    if (AS instanceof PDFName) return AS;\n    return undefined;\n  };\n\n  PDFAnnotation.prototype.setAppearanceState = function (state) {\n    this.dict.set(PDFName.of('AS'), state);\n  };\n\n  PDFAnnotation.prototype.setAppearances = function (appearances) {\n    this.dict.set(PDFName.of('AP'), appearances);\n  };\n\n  PDFAnnotation.prototype.ensureAP = function () {\n    var AP = this.AP();\n\n    if (!AP) {\n      AP = this.dict.context.obj({});\n      this.dict.set(PDFName.of('AP'), AP);\n    }\n\n    return AP;\n  };\n\n  PDFAnnotation.prototype.getNormalAppearance = function () {\n    var AP = this.ensureAP();\n    var N = AP.get(PDFName.of('N'));\n    if (N instanceof PDFRef || N instanceof PDFDict) return N;\n    throw new Error(\"Unexpected N type: \" + (N === null || N === void 0 ? void 0 : N.constructor.name));\n  };\n  /** @param appearance A PDFDict or PDFStream (direct or ref) */\n\n\n  PDFAnnotation.prototype.setNormalAppearance = function (appearance) {\n    var AP = this.ensureAP();\n    AP.set(PDFName.of('N'), appearance);\n  };\n  /** @param appearance A PDFDict or PDFStream (direct or ref) */\n\n\n  PDFAnnotation.prototype.setRolloverAppearance = function (appearance) {\n    var AP = this.ensureAP();\n    AP.set(PDFName.of('R'), appearance);\n  };\n  /** @param appearance A PDFDict or PDFStream (direct or ref) */\n\n\n  PDFAnnotation.prototype.setDownAppearance = function (appearance) {\n    var AP = this.ensureAP();\n    AP.set(PDFName.of('D'), appearance);\n  };\n\n  PDFAnnotation.prototype.removeRolloverAppearance = function () {\n    var AP = this.AP();\n    AP === null || AP === void 0 ? void 0 : AP.delete(PDFName.of('R'));\n  };\n\n  PDFAnnotation.prototype.removeDownAppearance = function () {\n    var AP = this.AP();\n    AP === null || AP === void 0 ? void 0 : AP.delete(PDFName.of('D'));\n  };\n\n  PDFAnnotation.prototype.getAppearances = function () {\n    var AP = this.AP();\n    if (!AP) return undefined;\n    var N = AP.lookup(PDFName.of('N'), PDFDict, PDFStream);\n    var R = AP.lookupMaybe(PDFName.of('R'), PDFDict, PDFStream);\n    var D = AP.lookupMaybe(PDFName.of('D'), PDFDict, PDFStream);\n    return {\n      normal: N,\n      rollover: R,\n      down: D\n    };\n  };\n\n  PDFAnnotation.prototype.getFlags = function () {\n    var _a, _b;\n\n    return (_b = (_a = this.F()) === null || _a === void 0 ? void 0 : _a.asNumber()) !== null && _b !== void 0 ? _b : 0;\n  };\n\n  PDFAnnotation.prototype.setFlags = function (flags) {\n    this.dict.set(PDFName.of('F'), PDFNumber.of(flags));\n  };\n\n  PDFAnnotation.prototype.hasFlag = function (flag) {\n    var flags = this.getFlags();\n    return (flags & flag) !== 0;\n  };\n\n  PDFAnnotation.prototype.setFlag = function (flag) {\n    var flags = this.getFlags();\n    this.setFlags(flags | flag);\n  };\n\n  PDFAnnotation.prototype.clearFlag = function (flag) {\n    var flags = this.getFlags();\n    this.setFlags(flags & ~flag);\n  };\n\n  PDFAnnotation.prototype.setFlagTo = function (flag, enable) {\n    if (enable) this.setFlag(flag);else this.clearFlag(flag);\n  };\n\n  PDFAnnotation.fromDict = function (dict) {\n    return new PDFAnnotation(dict);\n  };\n\n  return PDFAnnotation;\n}();\n\nexport default PDFAnnotation;","map":{"version":3,"sources":["../../../src/core/annotation/PDFAnnotation.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import PDFDict from \"../objects/PDFDict\";\nimport PDFName from \"../objects/PDFName\";\nimport PDFStream from \"../objects/PDFStream\";\nimport PDFArray from \"../objects/PDFArray\";\nimport PDFRef from \"../objects/PDFRef\";\nimport PDFNumber from \"../objects/PDFNumber\";\nvar PDFAnnotation = /** @class */ (function () {\n    function PDFAnnotation(dict) {\n        this.dict = dict;\n    }\n    // This is technically required by the PDF spec\n    PDFAnnotation.prototype.Rect = function () {\n        return this.dict.lookup(PDFName.of('Rect'), PDFArray);\n    };\n    PDFAnnotation.prototype.AP = function () {\n        return this.dict.lookupMaybe(PDFName.of('AP'), PDFDict);\n    };\n    PDFAnnotation.prototype.F = function () {\n        var numberOrRef = this.dict.lookup(PDFName.of('F'));\n        return this.dict.context.lookupMaybe(numberOrRef, PDFNumber);\n    };\n    PDFAnnotation.prototype.getRectangle = function () {\n        var _a;\n        var Rect = this.Rect();\n        return (_a = Rect === null || Rect === void 0 ? void 0 : Rect.asRectangle()) !== null && _a !== void 0 ? _a : { x: 0, y: 0, width: 0, height: 0 };\n    };\n    PDFAnnotation.prototype.setRectangle = function (rect) {\n        var x = rect.x, y = rect.y, width = rect.width, height = rect.height;\n        var Rect = this.dict.context.obj([x, y, x + width, y + height]);\n        this.dict.set(PDFName.of('Rect'), Rect);\n    };\n    PDFAnnotation.prototype.getAppearanceState = function () {\n        var AS = this.dict.lookup(PDFName.of('AS'));\n        if (AS instanceof PDFName)\n            return AS;\n        return undefined;\n    };\n    PDFAnnotation.prototype.setAppearanceState = function (state) {\n        this.dict.set(PDFName.of('AS'), state);\n    };\n    PDFAnnotation.prototype.setAppearances = function (appearances) {\n        this.dict.set(PDFName.of('AP'), appearances);\n    };\n    PDFAnnotation.prototype.ensureAP = function () {\n        var AP = this.AP();\n        if (!AP) {\n            AP = this.dict.context.obj({});\n            this.dict.set(PDFName.of('AP'), AP);\n        }\n        return AP;\n    };\n    PDFAnnotation.prototype.getNormalAppearance = function () {\n        var AP = this.ensureAP();\n        var N = AP.get(PDFName.of('N'));\n        if (N instanceof PDFRef || N instanceof PDFDict)\n            return N;\n        throw new Error(\"Unexpected N type: \" + (N === null || N === void 0 ? void 0 : N.constructor.name));\n    };\n    /** @param appearance A PDFDict or PDFStream (direct or ref) */\n    PDFAnnotation.prototype.setNormalAppearance = function (appearance) {\n        var AP = this.ensureAP();\n        AP.set(PDFName.of('N'), appearance);\n    };\n    /** @param appearance A PDFDict or PDFStream (direct or ref) */\n    PDFAnnotation.prototype.setRolloverAppearance = function (appearance) {\n        var AP = this.ensureAP();\n        AP.set(PDFName.of('R'), appearance);\n    };\n    /** @param appearance A PDFDict or PDFStream (direct or ref) */\n    PDFAnnotation.prototype.setDownAppearance = function (appearance) {\n        var AP = this.ensureAP();\n        AP.set(PDFName.of('D'), appearance);\n    };\n    PDFAnnotation.prototype.removeRolloverAppearance = function () {\n        var AP = this.AP();\n        AP === null || AP === void 0 ? void 0 : AP.delete(PDFName.of('R'));\n    };\n    PDFAnnotation.prototype.removeDownAppearance = function () {\n        var AP = this.AP();\n        AP === null || AP === void 0 ? void 0 : AP.delete(PDFName.of('D'));\n    };\n    PDFAnnotation.prototype.getAppearances = function () {\n        var AP = this.AP();\n        if (!AP)\n            return undefined;\n        var N = AP.lookup(PDFName.of('N'), PDFDict, PDFStream);\n        var R = AP.lookupMaybe(PDFName.of('R'), PDFDict, PDFStream);\n        var D = AP.lookupMaybe(PDFName.of('D'), PDFDict, PDFStream);\n        return { normal: N, rollover: R, down: D };\n    };\n    PDFAnnotation.prototype.getFlags = function () {\n        var _a, _b;\n        return (_b = (_a = this.F()) === null || _a === void 0 ? void 0 : _a.asNumber()) !== null && _b !== void 0 ? _b : 0;\n    };\n    PDFAnnotation.prototype.setFlags = function (flags) {\n        this.dict.set(PDFName.of('F'), PDFNumber.of(flags));\n    };\n    PDFAnnotation.prototype.hasFlag = function (flag) {\n        var flags = this.getFlags();\n        return (flags & flag) !== 0;\n    };\n    PDFAnnotation.prototype.setFlag = function (flag) {\n        var flags = this.getFlags();\n        this.setFlags(flags | flag);\n    };\n    PDFAnnotation.prototype.clearFlag = function (flag) {\n        var flags = this.getFlags();\n        this.setFlags(flags & ~flag);\n    };\n    PDFAnnotation.prototype.setFlagTo = function (flag, enable) {\n        if (enable)\n            this.setFlag(flag);\n        else\n            this.clearFlag(flag);\n    };\n    PDFAnnotation.fromDict = function (dict) { return new PDFAnnotation(dict); };\n    return PDFAnnotation;\n}());\nexport default PDFAnnotation;\n//# sourceMappingURL=PDFAnnotation.js.map"]},"metadata":{},"sourceType":"module"}