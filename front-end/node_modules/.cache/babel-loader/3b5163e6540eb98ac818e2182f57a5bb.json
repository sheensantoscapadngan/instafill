{"ast":null,"code":"import { __extends } from \"tslib\";\nimport PDFPage from \"../PDFPage\";\nimport PDFFont from \"../PDFFont\";\nimport PDFField, { assertFieldAppearanceOptions } from \"./PDFField\";\nimport { normalizeAppearance, defaultOptionListAppearanceProvider } from \"./appearances\";\nimport { rgb } from \"../colors\";\nimport { degrees } from \"../rotations\";\nimport { PDFHexString, PDFStream, PDFAcroListBox, AcroChoiceFlags } from \"../../core\";\nimport { assertIs, assertIsSubset, assertOrUndefined, assertPositive } from \"../../utils\";\n/**\n * Represents an option list field of a [[PDFForm]].\n *\n * [[PDFOptionList]] fields are interactive lists of options. The purpose of an\n * option list is to enable users to select one or more options from a set of\n * possible options. Users are able to see the full set of options without\n * first having to click on the field (though scrolling may be necessary).\n * Clicking an option in the list will cause it to be selected and displayed\n * with a highlighted background. Some option lists allow users to select\n * more than one option (see [[PDFOptionList.isMultiselect]]).\n */\n\nvar PDFOptionList =\n/** @class */\nfunction (_super) {\n  __extends(PDFOptionList, _super);\n\n  function PDFOptionList(acroListBox, ref, doc) {\n    var _this = _super.call(this, acroListBox, ref, doc) || this;\n\n    assertIs(acroListBox, 'acroListBox', [[PDFAcroListBox, 'PDFAcroListBox']]);\n    _this.acroField = acroListBox;\n    return _this;\n  }\n  /**\n   * Get the list of available options for this option list. These options will\n   * be displayed to users who view this option list in a PDF reader.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * const options = optionList.getOptions()\n   * console.log('Option List options:', options)\n   * ```\n   * @returns The options for this option list.\n   */\n\n\n  PDFOptionList.prototype.getOptions = function () {\n    var rawOptions = this.acroField.getOptions();\n    var options = new Array(rawOptions.length);\n\n    for (var idx = 0, len = options.length; idx < len; idx++) {\n      var _a = rawOptions[idx],\n          display = _a.display,\n          value = _a.value;\n      options[idx] = (display !== null && display !== void 0 ? display : value).decodeText();\n    }\n\n    return options;\n  };\n  /**\n   * Get the selected options for this option list. These are the values that\n   * were selected by a human user via a PDF reader, or programatically via\n   * software.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * const selections = optionList.getSelected()\n   * console.log('Option List selections:', selections)\n   * ```\n   * @returns The selected options for this option list.\n   */\n\n\n  PDFOptionList.prototype.getSelected = function () {\n    var values = this.acroField.getValues();\n    var selected = new Array(values.length);\n\n    for (var idx = 0, len = values.length; idx < len; idx++) {\n      selected[idx] = values[idx].decodeText();\n    }\n\n    return selected;\n  };\n  /**\n   * Set the list of options that are available for this option list. These are\n   * the values that will be available for users to select when they view this\n   * option list in a PDF reader. Note that preexisting options for this\n   * option list will be removed. Only the values passed as `options` will be\n   * available to select.\n   *\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('planets.optionList')\n   * optionList.setOptions(['Earth', 'Mars', 'Pluto', 'Venus'])\n   * ```\n   *\n   * This method will mark this option list as dirty, causing its appearance\n   * streams to be updated when either [[PDFDocument.save]] or\n   * [[PDFForm.updateFieldAppearances]] is called. The updated streams will\n   * display the options this field contains inside the widgets of this text\n   * field (with selected options highlighted).\n   *\n   * **IMPORTANT:** The default font used to update appearance streams is\n   * [[StandardFonts.Helvetica]]. Note that this is a WinAnsi font. This means\n   * that encoding errors will be thrown if this field contains any options\n   * with characters outside the WinAnsi character set (the latin alphabet).\n   *\n   * Embedding a custom font and passing it to\n   * [[PDFForm.updateFieldAppearances]] or [[PDFOptionList.updateAppearances]]\n   * allows you to generate appearance streams with characters outside the\n   * latin alphabet (assuming the custom font supports them).\n   *\n   * @param options The options that should be available in this option list.\n   */\n\n\n  PDFOptionList.prototype.setOptions = function (options) {\n    assertIs(options, 'options', [Array]);\n    this.markAsDirty();\n    var optionObjects = new Array(options.length);\n\n    for (var idx = 0, len = options.length; idx < len; idx++) {\n      optionObjects[idx] = {\n        value: PDFHexString.fromText(options[idx])\n      };\n    }\n\n    this.acroField.setOptions(optionObjects);\n  };\n  /**\n   * Add to the list of options that are available for this option list. Users\n   * will be able to select these values in a PDF reader. In addition to the\n   * values passed as `options`, any preexisting options for this option list\n   * will still be available for users to select.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('rockets.optionList')\n   * optionList.addOptions(['Saturn IV', 'Falcon Heavy'])\n   * ```\n   * This method will mark this option list as dirty. See\n   * [[PDFOptionList.setOptions]] for more details about what this means.\n   * @param options New options that should be available in this option list.\n   */\n\n\n  PDFOptionList.prototype.addOptions = function (options) {\n    assertIs(options, 'options', ['string', Array]);\n    this.markAsDirty();\n    var optionsArr = Array.isArray(options) ? options : [options];\n    var existingOptions = this.acroField.getOptions();\n    var newOptions = new Array(optionsArr.length);\n\n    for (var idx = 0, len = optionsArr.length; idx < len; idx++) {\n      newOptions[idx] = {\n        value: PDFHexString.fromText(optionsArr[idx])\n      };\n    }\n\n    this.acroField.setOptions(existingOptions.concat(newOptions));\n  };\n  /**\n   * Select one or more values for this option list. This operation is analogous\n   * to a human user opening the option list in a PDF reader and clicking on one\n   * or more values to select them. This method will update the underlying state\n   * of the option list to indicate which values have been selected. PDF\n   * libraries and readers will be able to extract these values from the saved\n   * document and determine which values were selected.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('best.superheroes.optionList')\n   * optionList.select(['One Punch Man', 'Iron Man'])\n   * ```\n   * This method will mark this option list as dirty. See\n   * [[PDFOptionList.setOptions]] for more details about what this means.\n   * @param options The options to be selected.\n   * @param merge Whether or not existing selections should be preserved.\n   */\n\n\n  PDFOptionList.prototype.select = function (options, merge) {\n    if (merge === void 0) {\n      merge = false;\n    }\n\n    assertIs(options, 'options', ['string', Array]);\n    assertIs(merge, 'merge', ['boolean']);\n    var optionsArr = Array.isArray(options) ? options : [options];\n    var validOptions = this.getOptions();\n    assertIsSubset(optionsArr, 'option', validOptions);\n    this.markAsDirty();\n\n    if (optionsArr.length > 1 || optionsArr.length === 1 && merge) {\n      this.enableMultiselect();\n    }\n\n    var values = new Array(optionsArr.length);\n\n    for (var idx = 0, len = optionsArr.length; idx < len; idx++) {\n      values[idx] = PDFHexString.fromText(optionsArr[idx]);\n    }\n\n    if (merge) {\n      var existingValues = this.acroField.getValues();\n      this.acroField.setValues(existingValues.concat(values));\n    } else {\n      this.acroField.setValues(values);\n    }\n  };\n  /**\n   * Clear all selected values for this option list. This operation is\n   * equivalent to selecting an empty list. This method will update the\n   * underlying state of the option list to indicate that no values have been\n   * selected.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.clear()\n   * ```\n   * This method will mark this option list as dirty. See\n   * [[PDFOptionList.setOptions]] for more details about what this means.\n   */\n\n\n  PDFOptionList.prototype.clear = function () {\n    this.markAsDirty();\n    this.acroField.setValues([]);\n  };\n  /**\n   * Set the font size for the text in this field. There needs to be a\n   * default appearance string (DA) set with a font value specified\n   * for this to work. For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.setFontSize(4);\n   * ```\n   * @param fontSize The font size to set the font to.\n   */\n\n  /**\n   * Set the font size for this field. Larger font sizes will result in larger\n   * text being displayed when PDF readers render this option list. Font sizes\n   * may be integer or floating point numbers. Supplying a negative font size\n   * will cause this method to throw an error.\n   *\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.setFontSize(4)\n   * optionList.setFontSize(15.7)\n   * ```\n   *\n   * > This method depends upon the existence of a default appearance\n   * > (`/DA`) string. If this field does not have a default appearance string,\n   * > or that string does not contain a font size (via the `Tf` operator),\n   * > then this method will throw an error.\n   *\n   * @param fontSize The font size to be used when rendering text in this field.\n   */\n\n\n  PDFOptionList.prototype.setFontSize = function (fontSize) {\n    assertPositive(fontSize, 'fontSize');\n    this.acroField.setFontSize(fontSize);\n    this.markAsDirty();\n  };\n  /**\n   * Returns `true` if the options of this option list are always displayed\n   * in alphabetical order, irrespective of the order in which the options\n   * were added to the option list. See [[PDFOptionList.enableSorting]] and\n   * [[PDFOptionList.disableSorting]]. For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * if (optionList.isSorted()) console.log('Sorting is enabled')\n   * ```\n   * @returns Whether or not this option list is sorted.\n   */\n\n\n  PDFOptionList.prototype.isSorted = function () {\n    return this.acroField.hasFlag(AcroChoiceFlags.Sort);\n  };\n  /**\n   * Always display the options of this option list in alphabetical order,\n   * irrespective of the order in which the options were added to this option\n   * list.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.enableSorting()\n   * ```\n   */\n\n\n  PDFOptionList.prototype.enableSorting = function () {\n    this.acroField.setFlagTo(AcroChoiceFlags.Sort, true);\n  };\n  /**\n   * Do not always display the options of this option list in alphabetical\n   * order. Instead, display the options in whichever order they were added\n   * to this option list. For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.disableSorting()\n   * ```\n   */\n\n\n  PDFOptionList.prototype.disableSorting = function () {\n    this.acroField.setFlagTo(AcroChoiceFlags.Sort, false);\n  };\n  /**\n   * Returns `true` if multiple options can be selected from this option list.\n   * See [[PDFOptionList.enableMultiselect]] and\n   * [[PDFOptionList.disableMultiselect]]. For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * if (optionList.isMultiselect()) console.log('Multiselect is enabled')\n   * ```\n   * @returns Whether or not multiple options can be selected.\n   */\n\n\n  PDFOptionList.prototype.isMultiselect = function () {\n    return this.acroField.hasFlag(AcroChoiceFlags.MultiSelect);\n  };\n  /**\n   * Allow users to select more than one option from this option list.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.enableMultiselect()\n   * ```\n   */\n\n\n  PDFOptionList.prototype.enableMultiselect = function () {\n    this.acroField.setFlagTo(AcroChoiceFlags.MultiSelect, true);\n  };\n  /**\n   * Do not allow users to select more than one option from this option list.\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.disableMultiselect()\n   * ```\n   */\n\n\n  PDFOptionList.prototype.disableMultiselect = function () {\n    this.acroField.setFlagTo(AcroChoiceFlags.MultiSelect, false);\n  };\n  /**\n   * Returns `true` if the option selected by a user is stored, or \"committed\",\n   * when the user clicks the option. The alternative is that the user's\n   * selection is stored when the user leaves this option list field (by\n   * clicking outside of it - on another field, for example). See\n   * [[PDFOptionList.enableSelectOnClick]] and\n   * [[PDFOptionList.disableSelectOnClick]]. For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * if (optionList.isSelectOnClick()) console.log('Select on click is enabled')\n   * ```\n   * @returns Whether or not options are selected immediately after they are\n   *          clicked.\n   */\n\n\n  PDFOptionList.prototype.isSelectOnClick = function () {\n    return this.acroField.hasFlag(AcroChoiceFlags.CommitOnSelChange);\n  };\n  /**\n   * Store the option selected by a user immediately after the user clicks the\n   * option. Do not wait for the user to leave this option list field (by\n   * clicking outside of it - on another field, for example). For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.enableSelectOnClick()\n   * ```\n   */\n\n\n  PDFOptionList.prototype.enableSelectOnClick = function () {\n    this.acroField.setFlagTo(AcroChoiceFlags.CommitOnSelChange, true);\n  };\n  /**\n   * Wait to store the option selected by a user until they leave this option\n   * list field (by clicking outside of it - on another field, for example).\n   * For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.disableSelectOnClick()\n   * ```\n   */\n\n\n  PDFOptionList.prototype.disableSelectOnClick = function () {\n    this.acroField.setFlagTo(AcroChoiceFlags.CommitOnSelChange, false);\n  };\n  /**\n   * Show this option list on the specified page. For example:\n   * ```js\n   * const ubuntuFont = await pdfDoc.embedFont(ubuntuFontBytes)\n   * const page = pdfDoc.addPage()\n   *\n   * const form = pdfDoc.getForm()\n   * const optionList = form.createOptionList('best.gundams')\n   * optionList.setOptions(['Exia', 'Dynames', 'Kyrios', 'Virtue'])\n   * optionList.select(['Exia', 'Virtue'])\n   *\n   * optionList.addToPage(page, {\n   *   x: 50,\n   *   y: 75,\n   *   width: 200,\n   *   height: 100,\n   *   textColor: rgb(1, 0, 0),\n   *   backgroundColor: rgb(0, 1, 0),\n   *   borderColor: rgb(0, 0, 1),\n   *   borderWidth: 2,\n   *   rotate: degrees(90),\n   *   font: ubuntuFont,\n   * })\n   * ```\n   * This will create a new widget for this option list field.\n   * @param page The page to which this option list widget should be added.\n   * @param options The options to be used when adding this option list widget.\n   */\n\n\n  PDFOptionList.prototype.addToPage = function (page, options) {\n    var _a, _b, _c, _d, _e, _f, _g;\n\n    assertIs(page, 'page', [[PDFPage, 'PDFPage']]);\n    assertFieldAppearanceOptions(options);\n    if (!options) options = {};\n    if (!('textColor' in options)) options.textColor = rgb(0, 0, 0);\n    if (!('backgroundColor' in options)) options.backgroundColor = rgb(1, 1, 1);\n    if (!('borderColor' in options)) options.borderColor = rgb(0, 0, 0);\n    if (!('borderWidth' in options)) options.borderWidth = 1; // Create a widget for this option list\n\n    var widget = this.createWidget({\n      x: (_a = options.x) !== null && _a !== void 0 ? _a : 0,\n      y: (_b = options.y) !== null && _b !== void 0 ? _b : 0,\n      width: (_c = options.width) !== null && _c !== void 0 ? _c : 200,\n      height: (_d = options.height) !== null && _d !== void 0 ? _d : 100,\n      textColor: options.textColor,\n      backgroundColor: options.backgroundColor,\n      borderColor: options.borderColor,\n      borderWidth: (_e = options.borderWidth) !== null && _e !== void 0 ? _e : 0,\n      rotate: (_f = options.rotate) !== null && _f !== void 0 ? _f : degrees(0),\n      hidden: options.hidden\n    });\n    var widgetRef = this.doc.context.register(widget.dict); // Add widget to this field\n\n    this.acroField.addWidget(widgetRef); // Set appearance streams for widget\n\n    var font = (_g = options.font) !== null && _g !== void 0 ? _g : this.doc.getForm().getDefaultFont();\n    this.updateWidgetAppearance(widget, font); // Add widget to the given page\n\n    page.node.addAnnot(widgetRef);\n  };\n  /**\n   * Returns `true` if this option list has been marked as dirty, or if any of\n   * this option list's widgets do not have an appearance stream. For example:\n   * ```js\n   * const optionList = form.getOptionList('some.optionList.field')\n   * if (optionList.needsAppearancesUpdate()) console.log('Needs update')\n   * ```\n   * @returns Whether or not this option list needs an appearance update.\n   */\n\n\n  PDFOptionList.prototype.needsAppearancesUpdate = function () {\n    var _a;\n\n    if (this.isDirty()) return true;\n    var widgets = this.acroField.getWidgets();\n\n    for (var idx = 0, len = widgets.length; idx < len; idx++) {\n      var widget = widgets[idx];\n      var hasAppearances = ((_a = widget.getAppearances()) === null || _a === void 0 ? void 0 : _a.normal) instanceof PDFStream;\n      if (!hasAppearances) return true;\n    }\n\n    return false;\n  };\n  /**\n   * Update the appearance streams for each of this option list's widgets using\n   * the default appearance provider for option lists. For example:\n   * ```js\n   * const helvetica = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.defaultUpdateAppearances(helvetica)\n   * ```\n   * @param font The font to be used for creating the appearance streams.\n   */\n\n\n  PDFOptionList.prototype.defaultUpdateAppearances = function (font) {\n    assertIs(font, 'font', [[PDFFont, 'PDFFont']]);\n    this.updateAppearances(font);\n  };\n  /**\n   * Update the appearance streams for each of this option list's widgets using\n   * the given appearance provider. If no `provider` is passed, the default\n   * appearance provider for option lists will be used. For example:\n   * ```js\n   * const helvetica = await pdfDoc.embedFont(StandardFonts.Helvetica)\n   * const optionList = form.getOptionList('some.optionList.field')\n   * optionList.updateAppearances(helvetica, (field, widget, font) => {\n   *   ...\n   *   return drawOptionList(...)\n   * })\n   * ```\n   * @param font The font to be used for creating the appearance streams.\n   * @param provider Optionally, the appearance provider to be used for\n   *                 generating the contents of the appearance streams.\n   */\n\n\n  PDFOptionList.prototype.updateAppearances = function (font, provider) {\n    assertIs(font, 'font', [[PDFFont, 'PDFFont']]);\n    assertOrUndefined(provider, 'provider', [Function]);\n    var widgets = this.acroField.getWidgets();\n\n    for (var idx = 0, len = widgets.length; idx < len; idx++) {\n      var widget = widgets[idx];\n      this.updateWidgetAppearance(widget, font, provider);\n    }\n\n    this.markAsClean();\n  }; // getOption(index: number): string {}\n  // getSelectedIndices(): number[] {}\n  // removeOptions(option: string | string[]) {}\n  // removeIndices(option: number[]) {}\n  // deselect(options: string | string[]) {}\n  // deselectIndices(optionIndices: number[]) {}\n\n\n  PDFOptionList.prototype.updateWidgetAppearance = function (widget, font, provider) {\n    var apProvider = provider !== null && provider !== void 0 ? provider : defaultOptionListAppearanceProvider;\n    var appearances = normalizeAppearance(apProvider(this, widget, font));\n    this.updateWidgetAppearanceWithFont(widget, font, appearances);\n  };\n  /**\n   * > **NOTE:** You probably don't want to call this method directly. Instead,\n   * > consider using the [[PDFForm.getOptionList]] method, which will create\n   * > an instance of [[PDFOptionList]] for you.\n   *\n   * Create an instance of [[PDFOptionList]] from an existing acroListBox and\n   * ref\n   *\n   * @param acroComboBox The underlying `PDFAcroListBox` for this option list.\n   * @param ref The unique reference for this option list.\n   * @param doc The document to which this option list will belong.\n   */\n\n\n  PDFOptionList.of = function (acroListBox, ref, doc) {\n    return new PDFOptionList(acroListBox, ref, doc);\n  };\n\n  return PDFOptionList;\n}(PDFField);\n\nexport default PDFOptionList;","map":{"version":3,"sources":["../../../src/api/form/PDFOptionList.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __extends } from \"tslib\";\nimport PDFPage from \"../PDFPage\";\nimport PDFFont from \"../PDFFont\";\nimport PDFField, { assertFieldAppearanceOptions, } from \"./PDFField\";\nimport { normalizeAppearance, defaultOptionListAppearanceProvider, } from \"./appearances\";\nimport { rgb } from \"../colors\";\nimport { degrees } from \"../rotations\";\nimport { PDFHexString, PDFStream, PDFAcroListBox, AcroChoiceFlags, } from \"../../core\";\nimport { assertIs, assertIsSubset, assertOrUndefined, assertPositive, } from \"../../utils\";\n/**\n * Represents an option list field of a [[PDFForm]].\n *\n * [[PDFOptionList]] fields are interactive lists of options. The purpose of an\n * option list is to enable users to select one or more options from a set of\n * possible options. Users are able to see the full set of options without\n * first having to click on the field (though scrolling may be necessary).\n * Clicking an option in the list will cause it to be selected and displayed\n * with a highlighted background. Some option lists allow users to select\n * more than one option (see [[PDFOptionList.isMultiselect]]).\n */\nvar PDFOptionList = /** @class */ (function (_super) {\n    __extends(PDFOptionList, _super);\n    function PDFOptionList(acroListBox, ref, doc) {\n        var _this = _super.call(this, acroListBox, ref, doc) || this;\n        assertIs(acroListBox, 'acroListBox', [[PDFAcroListBox, 'PDFAcroListBox']]);\n        _this.acroField = acroListBox;\n        return _this;\n    }\n    /**\n     * Get the list of available options for this option list. These options will\n     * be displayed to users who view this option list in a PDF reader.\n     * For example:\n     * ```js\n     * const optionList = form.getOptionList('some.optionList.field')\n     * const options = optionList.getOptions()\n     * console.log('Option List options:', options)\n     * ```\n     * @returns The options for this option list.\n     */\n    PDFOptionList.prototype.getOptions = function () {\n        var rawOptions = this.acroField.getOptions();\n        var options = new Array(rawOptions.length);\n        for (var idx = 0, len = options.length; idx < len; idx++) {\n            var _a = rawOptions[idx], display = _a.display, value = _a.value;\n            options[idx] = (display !== null && display !== void 0 ? display : value).decodeText();\n        }\n        return options;\n    };\n    /**\n     * Get the selected options for this option list. These are the values that\n     * were selected by a human user via a PDF reader, or programatically via\n     * software.\n     * For example:\n     * ```js\n     * const optionList = form.getOptionList('some.optionList.field')\n     * const selections = optionList.getSelected()\n     * console.log('Option List selections:', selections)\n     * ```\n     * @returns The selected options for this option list.\n     */\n    PDFOptionList.prototype.getSelected = function () {\n        var values = this.acroField.getValues();\n        var selected = new Array(values.length);\n        for (var idx = 0, len = values.length; idx < len; idx++) {\n            selected[idx] = values[idx].decodeText();\n        }\n        return selected;\n    };\n    /**\n     * Set the list of options that are available for this option list. These are\n     * the values that will be available for users to select when they view this\n     * option list in a PDF reader. Note that preexisting options for this\n     * option list will be removed. Only the values passed as `options` will be\n     * available to select.\n     *\n     * For example:\n     * ```js\n     * const optionList = form.getOptionList('planets.optionList')\n     * optionList.setOptions(['Earth', 'Mars', 'Pluto', 'Venus'])\n     * ```\n     *\n     * This method will mark this option list as dirty, causing its appearance\n     * streams to be updated when either [[PDFDocument.save]] or\n     * [[PDFForm.updateFieldAppearances]] is called. The updated streams will\n     * display the options this field contains inside the widgets of this text\n     * field (with selected options highlighted).\n     *\n     * **IMPORTANT:** The default font used to update appearance streams is\n     * [[StandardFonts.Helvetica]]. Note that this is a WinAnsi font. This means\n     * that encoding errors will be thrown if this field contains any options\n     * with characters outside the WinAnsi character set (the latin alphabet).\n     *\n     * Embedding a custom font and passing it to\n     * [[PDFForm.updateFieldAppearances]] or [[PDFOptionList.updateAppearances]]\n     * allows you to generate appearance streams with characters outside the\n     * latin alphabet (assuming the custom font supports them).\n     *\n     * @param options The options that should be available in this option list.\n     */\n    PDFOptionList.prototype.setOptions = function (options) {\n        assertIs(options, 'options', [Array]);\n        this.markAsDirty();\n        var optionObjects = new Array(options.length);\n        for (var idx = 0, len = options.length; idx < len; idx++) {\n            optionObjects[idx] = { value: PDFHexString.fromText(options[idx]) };\n        }\n        this.acroField.setOptions(optionObjects);\n    };\n    /**\n     * Add to the list of options that are available for this option list. Users\n     * will be able to select these values in a PDF reader. In addition to the\n     * values passed as `options`, any preexisting options for this option list\n     * will still be available for users to select.\n     * For example:\n     * ```js\n     * const optionList = form.getOptionList('rockets.optionList')\n     * optionList.addOptions(['Saturn IV', 'Falcon Heavy'])\n     * ```\n     * This method will mark this option list as dirty. See\n     * [[PDFOptionList.setOptions]] for more details about what this means.\n     * @param options New options that should be available in this option list.\n     */\n    PDFOptionList.prototype.addOptions = function (options) {\n        assertIs(options, 'options', ['string', Array]);\n        this.markAsDirty();\n        var optionsArr = Array.isArray(options) ? options : [options];\n        var existingOptions = this.acroField.getOptions();\n        var newOptions = new Array(optionsArr.length);\n        for (var idx = 0, len = optionsArr.length; idx < len; idx++) {\n            newOptions[idx] = { value: PDFHexString.fromText(optionsArr[idx]) };\n        }\n        this.acroField.setOptions(existingOptions.concat(newOptions));\n    };\n    /**\n     * Select one or more values for this option list. This operation is analogous\n     * to a human user opening the option list in a PDF reader and clicking on one\n     * or more values to select them. This method will update the underlying state\n     * of the option list to indicate which values have been selected. PDF\n     * libraries and readers will be able to extract these values from the saved\n     * document and determine which values were selected.\n     * For example:\n     * ```js\n     * const optionList = form.getOptionList('best.superheroes.optionList')\n     * optionList.select(['One Punch Man', 'Iron Man'])\n     * ```\n     * This method will mark this option list as dirty. See\n     * [[PDFOptionList.setOptions]] for more details about what this means.\n     * @param options The options to be selected.\n     * @param merge Whether or not existing selections should be preserved.\n     */\n    PDFOptionList.prototype.select = function (options, merge) {\n        if (merge === void 0) { merge = false; }\n        assertIs(options, 'options', ['string', Array]);\n        assertIs(merge, 'merge', ['boolean']);\n        var optionsArr = Array.isArray(options) ? options : [options];\n        var validOptions = this.getOptions();\n        assertIsSubset(optionsArr, 'option', validOptions);\n        this.markAsDirty();\n        if (optionsArr.length > 1 || (optionsArr.length === 1 && merge)) {\n            this.enableMultiselect();\n        }\n        var values = new Array(optionsArr.length);\n        for (var idx = 0, len = optionsArr.length; idx < len; idx++) {\n            values[idx] = PDFHexString.fromText(optionsArr[idx]);\n        }\n        if (merge) {\n            var existingValues = this.acroField.getValues();\n            this.acroField.setValues(existingValues.concat(values));\n        }\n        else {\n            this.acroField.setValues(values);\n        }\n    };\n    /**\n     * Clear all selected values for this option list. This operation is\n     * equivalent to selecting an empty list. This method will update the\n     * underlying state of the option list to indicate that no values have been\n     * selected.\n     * For example:\n     * ```js\n     * const optionList = form.getOptionList('some.optionList.field')\n     * optionList.clear()\n     * ```\n     * This method will mark this option list as dirty. See\n     * [[PDFOptionList.setOptions]] for more details about what this means.\n     */\n    PDFOptionList.prototype.clear = function () {\n        this.markAsDirty();\n        this.acroField.setValues([]);\n    };\n    /**\n     * Set the font size for the text in this field. There needs to be a\n     * default appearance string (DA) set with a font value specified\n     * for this to work. For example:\n     * ```js\n     * const optionList = form.getOptionList('some.optionList.field')\n     * optionList.setFontSize(4);\n     * ```\n     * @param fontSize The font size to set the font to.\n     */\n    /**\n     * Set the font size for this field. Larger font sizes will result in larger\n     * text being displayed when PDF readers render this option list. Font sizes\n     * may be integer or floating point numbers. Supplying a negative font size\n     * will cause this method to throw an error.\n     *\n     * For example:\n     * ```js\n     * const optionList = form.getOptionList('some.optionList.field')\n     * optionList.setFontSize(4)\n     * optionList.setFontSize(15.7)\n     * ```\n     *\n     * > This method depends upon the existence of a default appearance\n     * > (`/DA`) string. If this field does not have a default appearance string,\n     * > or that string does not contain a font size (via the `Tf` operator),\n     * > then this method will throw an error.\n     *\n     * @param fontSize The font size to be used when rendering text in this field.\n     */\n    PDFOptionList.prototype.setFontSize = function (fontSize) {\n        assertPositive(fontSize, 'fontSize');\n        this.acroField.setFontSize(fontSize);\n        this.markAsDirty();\n    };\n    /**\n     * Returns `true` if the options of this option list are always displayed\n     * in alphabetical order, irrespective of the order in which the options\n     * were added to the option list. See [[PDFOptionList.enableSorting]] and\n     * [[PDFOptionList.disableSorting]]. For example:\n     * ```js\n     * const optionList = form.getOptionList('some.optionList.field')\n     * if (optionList.isSorted()) console.log('Sorting is enabled')\n     * ```\n     * @returns Whether or not this option list is sorted.\n     */\n    PDFOptionList.prototype.isSorted = function () {\n        return this.acroField.hasFlag(AcroChoiceFlags.Sort);\n    };\n    /**\n     * Always display the options of this option list in alphabetical order,\n     * irrespective of the order in which the options were added to this option\n     * list.\n     * For example:\n     * ```js\n     * const optionList = form.getOptionList('some.optionList.field')\n     * optionList.enableSorting()\n     * ```\n     */\n    PDFOptionList.prototype.enableSorting = function () {\n        this.acroField.setFlagTo(AcroChoiceFlags.Sort, true);\n    };\n    /**\n     * Do not always display the options of this option list in alphabetical\n     * order. Instead, display the options in whichever order they were added\n     * to this option list. For example:\n     * ```js\n     * const optionList = form.getOptionList('some.optionList.field')\n     * optionList.disableSorting()\n     * ```\n     */\n    PDFOptionList.prototype.disableSorting = function () {\n        this.acroField.setFlagTo(AcroChoiceFlags.Sort, false);\n    };\n    /**\n     * Returns `true` if multiple options can be selected from this option list.\n     * See [[PDFOptionList.enableMultiselect]] and\n     * [[PDFOptionList.disableMultiselect]]. For example:\n     * ```js\n     * const optionList = form.getOptionList('some.optionList.field')\n     * if (optionList.isMultiselect()) console.log('Multiselect is enabled')\n     * ```\n     * @returns Whether or not multiple options can be selected.\n     */\n    PDFOptionList.prototype.isMultiselect = function () {\n        return this.acroField.hasFlag(AcroChoiceFlags.MultiSelect);\n    };\n    /**\n     * Allow users to select more than one option from this option list.\n     * For example:\n     * ```js\n     * const optionList = form.getOptionList('some.optionList.field')\n     * optionList.enableMultiselect()\n     * ```\n     */\n    PDFOptionList.prototype.enableMultiselect = function () {\n        this.acroField.setFlagTo(AcroChoiceFlags.MultiSelect, true);\n    };\n    /**\n     * Do not allow users to select more than one option from this option list.\n     * For example:\n     * ```js\n     * const optionList = form.getOptionList('some.optionList.field')\n     * optionList.disableMultiselect()\n     * ```\n     */\n    PDFOptionList.prototype.disableMultiselect = function () {\n        this.acroField.setFlagTo(AcroChoiceFlags.MultiSelect, false);\n    };\n    /**\n     * Returns `true` if the option selected by a user is stored, or \"committed\",\n     * when the user clicks the option. The alternative is that the user's\n     * selection is stored when the user leaves this option list field (by\n     * clicking outside of it - on another field, for example). See\n     * [[PDFOptionList.enableSelectOnClick]] and\n     * [[PDFOptionList.disableSelectOnClick]]. For example:\n     * ```js\n     * const optionList = form.getOptionList('some.optionList.field')\n     * if (optionList.isSelectOnClick()) console.log('Select on click is enabled')\n     * ```\n     * @returns Whether or not options are selected immediately after they are\n     *          clicked.\n     */\n    PDFOptionList.prototype.isSelectOnClick = function () {\n        return this.acroField.hasFlag(AcroChoiceFlags.CommitOnSelChange);\n    };\n    /**\n     * Store the option selected by a user immediately after the user clicks the\n     * option. Do not wait for the user to leave this option list field (by\n     * clicking outside of it - on another field, for example). For example:\n     * ```js\n     * const optionList = form.getOptionList('some.optionList.field')\n     * optionList.enableSelectOnClick()\n     * ```\n     */\n    PDFOptionList.prototype.enableSelectOnClick = function () {\n        this.acroField.setFlagTo(AcroChoiceFlags.CommitOnSelChange, true);\n    };\n    /**\n     * Wait to store the option selected by a user until they leave this option\n     * list field (by clicking outside of it - on another field, for example).\n     * For example:\n     * ```js\n     * const optionList = form.getOptionList('some.optionList.field')\n     * optionList.disableSelectOnClick()\n     * ```\n     */\n    PDFOptionList.prototype.disableSelectOnClick = function () {\n        this.acroField.setFlagTo(AcroChoiceFlags.CommitOnSelChange, false);\n    };\n    /**\n     * Show this option list on the specified page. For example:\n     * ```js\n     * const ubuntuFont = await pdfDoc.embedFont(ubuntuFontBytes)\n     * const page = pdfDoc.addPage()\n     *\n     * const form = pdfDoc.getForm()\n     * const optionList = form.createOptionList('best.gundams')\n     * optionList.setOptions(['Exia', 'Dynames', 'Kyrios', 'Virtue'])\n     * optionList.select(['Exia', 'Virtue'])\n     *\n     * optionList.addToPage(page, {\n     *   x: 50,\n     *   y: 75,\n     *   width: 200,\n     *   height: 100,\n     *   textColor: rgb(1, 0, 0),\n     *   backgroundColor: rgb(0, 1, 0),\n     *   borderColor: rgb(0, 0, 1),\n     *   borderWidth: 2,\n     *   rotate: degrees(90),\n     *   font: ubuntuFont,\n     * })\n     * ```\n     * This will create a new widget for this option list field.\n     * @param page The page to which this option list widget should be added.\n     * @param options The options to be used when adding this option list widget.\n     */\n    PDFOptionList.prototype.addToPage = function (page, options) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        assertIs(page, 'page', [[PDFPage, 'PDFPage']]);\n        assertFieldAppearanceOptions(options);\n        if (!options)\n            options = {};\n        if (!('textColor' in options))\n            options.textColor = rgb(0, 0, 0);\n        if (!('backgroundColor' in options))\n            options.backgroundColor = rgb(1, 1, 1);\n        if (!('borderColor' in options))\n            options.borderColor = rgb(0, 0, 0);\n        if (!('borderWidth' in options))\n            options.borderWidth = 1;\n        // Create a widget for this option list\n        var widget = this.createWidget({\n            x: (_a = options.x) !== null && _a !== void 0 ? _a : 0,\n            y: (_b = options.y) !== null && _b !== void 0 ? _b : 0,\n            width: (_c = options.width) !== null && _c !== void 0 ? _c : 200,\n            height: (_d = options.height) !== null && _d !== void 0 ? _d : 100,\n            textColor: options.textColor,\n            backgroundColor: options.backgroundColor,\n            borderColor: options.borderColor,\n            borderWidth: (_e = options.borderWidth) !== null && _e !== void 0 ? _e : 0,\n            rotate: (_f = options.rotate) !== null && _f !== void 0 ? _f : degrees(0),\n            hidden: options.hidden,\n        });\n        var widgetRef = this.doc.context.register(widget.dict);\n        // Add widget to this field\n        this.acroField.addWidget(widgetRef);\n        // Set appearance streams for widget\n        var font = (_g = options.font) !== null && _g !== void 0 ? _g : this.doc.getForm().getDefaultFont();\n        this.updateWidgetAppearance(widget, font);\n        // Add widget to the given page\n        page.node.addAnnot(widgetRef);\n    };\n    /**\n     * Returns `true` if this option list has been marked as dirty, or if any of\n     * this option list's widgets do not have an appearance stream. For example:\n     * ```js\n     * const optionList = form.getOptionList('some.optionList.field')\n     * if (optionList.needsAppearancesUpdate()) console.log('Needs update')\n     * ```\n     * @returns Whether or not this option list needs an appearance update.\n     */\n    PDFOptionList.prototype.needsAppearancesUpdate = function () {\n        var _a;\n        if (this.isDirty())\n            return true;\n        var widgets = this.acroField.getWidgets();\n        for (var idx = 0, len = widgets.length; idx < len; idx++) {\n            var widget = widgets[idx];\n            var hasAppearances = ((_a = widget.getAppearances()) === null || _a === void 0 ? void 0 : _a.normal) instanceof PDFStream;\n            if (!hasAppearances)\n                return true;\n        }\n        return false;\n    };\n    /**\n     * Update the appearance streams for each of this option list's widgets using\n     * the default appearance provider for option lists. For example:\n     * ```js\n     * const helvetica = await pdfDoc.embedFont(StandardFonts.Helvetica)\n     * const optionList = form.getOptionList('some.optionList.field')\n     * optionList.defaultUpdateAppearances(helvetica)\n     * ```\n     * @param font The font to be used for creating the appearance streams.\n     */\n    PDFOptionList.prototype.defaultUpdateAppearances = function (font) {\n        assertIs(font, 'font', [[PDFFont, 'PDFFont']]);\n        this.updateAppearances(font);\n    };\n    /**\n     * Update the appearance streams for each of this option list's widgets using\n     * the given appearance provider. If no `provider` is passed, the default\n     * appearance provider for option lists will be used. For example:\n     * ```js\n     * const helvetica = await pdfDoc.embedFont(StandardFonts.Helvetica)\n     * const optionList = form.getOptionList('some.optionList.field')\n     * optionList.updateAppearances(helvetica, (field, widget, font) => {\n     *   ...\n     *   return drawOptionList(...)\n     * })\n     * ```\n     * @param font The font to be used for creating the appearance streams.\n     * @param provider Optionally, the appearance provider to be used for\n     *                 generating the contents of the appearance streams.\n     */\n    PDFOptionList.prototype.updateAppearances = function (font, provider) {\n        assertIs(font, 'font', [[PDFFont, 'PDFFont']]);\n        assertOrUndefined(provider, 'provider', [Function]);\n        var widgets = this.acroField.getWidgets();\n        for (var idx = 0, len = widgets.length; idx < len; idx++) {\n            var widget = widgets[idx];\n            this.updateWidgetAppearance(widget, font, provider);\n        }\n        this.markAsClean();\n    };\n    // getOption(index: number): string {}\n    // getSelectedIndices(): number[] {}\n    // removeOptions(option: string | string[]) {}\n    // removeIndices(option: number[]) {}\n    // deselect(options: string | string[]) {}\n    // deselectIndices(optionIndices: number[]) {}\n    PDFOptionList.prototype.updateWidgetAppearance = function (widget, font, provider) {\n        var apProvider = provider !== null && provider !== void 0 ? provider : defaultOptionListAppearanceProvider;\n        var appearances = normalizeAppearance(apProvider(this, widget, font));\n        this.updateWidgetAppearanceWithFont(widget, font, appearances);\n    };\n    /**\n     * > **NOTE:** You probably don't want to call this method directly. Instead,\n     * > consider using the [[PDFForm.getOptionList]] method, which will create\n     * > an instance of [[PDFOptionList]] for you.\n     *\n     * Create an instance of [[PDFOptionList]] from an existing acroListBox and\n     * ref\n     *\n     * @param acroComboBox The underlying `PDFAcroListBox` for this option list.\n     * @param ref The unique reference for this option list.\n     * @param doc The document to which this option list will belong.\n     */\n    PDFOptionList.of = function (acroListBox, ref, doc) {\n        return new PDFOptionList(acroListBox, ref, doc);\n    };\n    return PDFOptionList;\n}(PDFField));\nexport default PDFOptionList;\n//# sourceMappingURL=PDFOptionList.js.map"]},"metadata":{},"sourceType":"module"}